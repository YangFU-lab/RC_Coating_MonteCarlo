function theta_2=F_fresnel_2(n2,k2,theta_1)
%% ========================================================================
% Fresnel折射角计算（考虑吸收介质）
% 功能：计算光从空气进入吸收介质时的折射角
% ========================================================================
% 输入参数：
%   n2, k2 - 介质的折射率和消光系数
%   theta_1 - 入射角（弧度）
% 输出参数：
%   theta_2 - 折射角（弧度）
% ========================================================================
    % 计算折射角（考虑介质的吸收）
    temp=n2^2-k2^2-sin(theta_1)^2;
    p_sq=0.5*(sqrt(temp^2+4*n2^2*k2^2)+temp);  % 折射角相关的中间量
    theta_2=atan(sin(theta_1)/sqrt(p_sq));      % 折射角
end
 

